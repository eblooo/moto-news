apiVersion: v1
kind: ConfigMap
metadata:
  name: aggregator-config
  namespace: moto-news
  labels:
    app: aggregator
data:
  config.yaml: |
    sources:
      - name: rideapart
        feeds:
          - https://www.rideapart.com/rss/news/all/
          - https://www.rideapart.com/rss/reviews/all/
          - https://www.rideapart.com/rss/features/all/
        enabled: true

    translator:
      provider: ollama
      ollama:
        # CPU-only server (i5-4590, 24GB RAM, no GPU):
        # gemma2:9b    — best quality/speed for Russian (~5-8 tok/s on CPU)
        # llama3.2:3b  — fast (~20 tok/s), lower quality
        model: gemma2:9b
        host: http://host.cni.cncf.io:11434   # Ollama on host (microk8s)
        temperature: 0.15
        top_p: 0.9
        num_ctx: 8192
        prompt: |
          Ты — профессиональный мотожурналист-переводчик с английского на русский.
          Твоя задача — переводить статьи о мотоциклах так, чтобы они читались как оригинальный русскоязычный мотожурналистский текст, а НЕ как машинный перевод.

          ПРАВИЛА:
          - Переводи СМЫСЛ, а не слова. Адаптируй идиомы и сленг под русский язык.
          - Используй естественный разговорный стиль русской мотожурналистики.
          - Повествование от мужского лица (я поехал, я попробовал, я увидел).
          - Названия брендов и моделей мотоциклов оставляй на английском (Yamaha YZF-R1, Ducati Panigale, Stark Varg).
          - Единицы измерения переводи в метрические, если они в имперских.
          - НЕ добавляй комментариев, пояснений, преамбул — верни ТОЛЬКО перевод.
          - Сохраняй абзацы и структуру оригинала.

          ГЛОССАРИЙ (используй эти термины):
          - trike = трайк
          - lane splitting = езда между рядов
          - lane filtering = фильтрация в потоке
          - shoulder (road) = обочина
          - shoulder riding = езда по обочине
          - torque = крутящий момент
          - horsepower / hp = лошадиных сил / л.с.
          - naked bike = нейкед
          - sportbike = спортбайк
          - cruiser = круизер
          - adventure bike = эндуро-турер / адвенчур
          - dual-sport = эндуро
          - touring = туринг / турер
          - scrambler = скрэмблер
          - wheelie = вилли
          - stoppie = стоппи
          - lowside = лоусайд
          - highside = хайсайд
          - lean angle = угол наклона
          - cornering = прохождение поворотов
          - throttle = газ / ручка газа
          - clutch = сцепление
          - fairing = обтекатель
          - swingarm = маятник
          - rear sets = подножки
          - track day = трек-день
          - brain rot (slang) = помешательство / мотопомешательство
          - rider = мотоциклист / райдер
          - gear (equipment) = экипировка
          - winglet = винглет / аэродинамический элемент
          - MotoGP aero = аэродинамика MotoGP
        title_prompt: |
          Ты — редактор русскоязычного мотоциклетного медиа.
          Переведи заголовок статьи на русский язык.

          ПРАВИЛА:
          - Заголовок должен быть цепляющим и естественным для русского читателя.
          - НЕ переводи дословно — адаптируй смысл.
          - Сленг и идиомы заменяй русскими эквивалентами.
          - Названия брендов и моделей оставляй на английском.
          - Максимум 15 слов.
          - Верни ТОЛЬКО переведённый заголовок, без кавычек и пояснений.
      deepl:
        # api_key: set via DEEPL_API_KEY env var
        free: true
      libretranslate:
        host: http://localhost:5050

    database:
      path: /app/data/moto-news.db

    hugo:
      path: /app/blog
      content_dir: content
      auto_commit: true
      git_repo: https://github.com/KlimDos/my-blog.git
      git_remote: origin
      git_branch: main

    server:
      host: 0.0.0.0
      port: 8080

    schedule:
      fetch_interval: 6h
      translate_batch: 5
